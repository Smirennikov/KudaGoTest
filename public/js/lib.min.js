"use strict";!function(){var c,e,t,n,i=new XMLHttpRequest,r=document.querySelector(".initial-screen"),s=((e=document.createElement("section")).className="section kudaGo-section-events container flex",r.after(e),e),o=function(e){var t=document.createElement("div"),n=document.createElement("h3"),i=document.createElement("button"),r=document.createElement("p"),o=document.createElement("p"),a=document.createElement("p");t.className="kudaGo-event flex",o.className="price",i.className="button kudaGo-event__button-favorite",i.innerHTML="Добавить в избранное",n.innerHTML=c[e].title,r.innerHTML=c[e].description,o.innerHTML=c[e].price,a.innerHTML=c[e].type,t.appendChild(n),t.appendChild(r),t.appendChild(o),t.appendChild(a),t.appendChild(i),s.appendChild(t)},a=function(){for(var e=document.querySelectorAll(".kudaGo-event__button-favorite"),t=e.length,n=0;n<t;n+=1)"favorite"===localStorage.getItem(e[n].parentNode.querySelector("h3").innerHTML)?(e[n].classList.add("favorite"),e[n].innerHTML="В избранном"):(e[n].classList.remove("favorite"),e[n].innerHTML="Добавить в избранное"),e[n].addEventListener("click",function(){var e=this.parentNode.querySelector("h3").innerHTML;this.classList.toggle("favorite"),"button kudaGo-event__button-favorite favorite"===this.getAttribute("class")?(this.innerHTML="В избранном",localStorage.setItem(e,"favorite")):(this.innerHTML="Добавить в избранное",localStorage.removeItem(e,"favorite"))})},l=function(){for(var e=[],t=c.length,n=0;n<t;n+=1)e.push(c[n].price);return e.sort(function(e,t){return e-t}),e};t=document.querySelector(".kudaGo-form input"),n=document.querySelector(".section"),t.addEventListener("keyup",function(){""===t.value?(n.innerHTML="",f(o)):(n.innerHTML="",function(e){for(var t=c.length,n=0;n<t;n+=1)(e.test(c[n].title)||e.test(c[n].description))&&(o(n),a())}(new RegExp(t.value,"i"))),console.log(t.value)});function u(e){var t,n,i=document.querySelectorAll(".kudaGo-section-events .kudaGo-event"),r=i.length;if("up"===e)for(var o=0;o<r;o+=1)i[o].style.order=(n=o,l().indexOf(parseInt(i[n].querySelector(".price").innerHTML)));else if("down"===e)for(o=0;o<r;o+=1)i[o].style.order=(t=o,l().reverse().indexOf(parseInt(i[t].querySelector(".price").innerHTML)))}function v(e){for(var t=c.length,n=0;n<t;n+=1)c[n].type===e&&(o(n),a())}function d(e){for(var t=c.length,n=0;n<t;n+=1)c[n].title===e&&(o(n),a())}function f(e){for(var t=c.length,n=0;n<t;n+=1)e(n);a()}i.open("GET","data.json",!1),i.send(),4===i.readyState&&(c=i.responseText,c=JSON.parse(c),f(o),function(){for(var t=document.querySelectorAll(".kudaGo-form .button"),e=t.length,n=0;n<e;n+=1)t[n].addEventListener("click",function(e){e.preventDefault(),"Концерты"===this.innerHTML?(t[1].classList.remove("active"),t[2].classList.remove("active"),t[3].classList.remove("active"),this.classList.toggle("active"),"button active"===this.getAttribute("class")?(s.innerHTML="",v("concert")):(s.innerHTML="",f(o))):"Выставки"===this.innerHTML&&(t[0].classList.remove("active"),t[2].classList.remove("active"),t[3].classList.remove("active"),this.classList.toggle("active"),"button active"===this.getAttribute("class")?(s.innerHTML="",v("exhibition")):(s.innerHTML="",f(o)))})}(),function(){for(var n=document.querySelectorAll(".kudaGo-tabs .tab"),i=document.querySelector(".kudaGo-form"),r=document.querySelector(".section"),e=n.length,t=0;t<e;t+=1)n[t].addEventListener("click",function(){if(this.classList.toggle("active"),"Избранные события"===this.innerHTML){n[0].classList.remove("active"),n[1].classList.add("active"),i.style.display="none",r.innerHTML="";for(var e=0,t=c.length;e<t;e+=1)"favorite"===localStorage.getItem(c[e].title)&&d(c[e].title)}else"Поиск событий"===this.innerHTML&&(i.style.display="block",n[1].classList.remove("active"),n[0].classList.add("active"),r.innerHTML="",f(o))})}(),function(){for(var t=document.querySelectorAll(".kudaGo-form .button"),e=t.length,n=2;n<e;n+=1)t[n].addEventListener("click",function(e){e.preventDefault(),this.classList.add("active"),"По возрастанию"===this.innerHTML?"button active"===this.getAttribute("class")?(t[3].classList.remove("active"),u("up")):(s.innerHTML="",f(o)):"По убыванию"===this.innerHTML&&("button active"===this.getAttribute("class")?(t[2].classList.remove("active"),u("down")):(s.innerHTML="",f(o)))})}())}();
